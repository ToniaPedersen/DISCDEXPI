(()=>{var t={462:t=>{t.exports=function(t){var a=[];return t.replace(r,(function(t,r,o){var i=r.toLowerCase();for(o=function(t){var e=t.match(n);return e?e.map(Number):[]}(o),"m"==i&&o.length>2&&(a.push([r].concat(o.splice(0,2))),i="l",r="m"==r?"l":"L");;){if(o.length==e[i])return o.unshift(r),a.push(o);if(o.length<e[i])throw new Error("malformed path data");a.push([r].concat(o.splice(0,e[i])))}})),a};var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/gi,n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},721:(t,e,r)=>{"use strict";t.exports=r(192)},921:t=>{"use strict";var e=2*Math.PI;function r(t,e,r,n){var a=t*r+e*n;return a>1&&(a=1),a<-1&&(a=-1),(t*n-e*r<0?-1:1)*Math.acos(a)}function n(t,e){var r=4/3*Math.tan(e/4),n=Math.cos(t),a=Math.sin(t),o=Math.cos(t+e),i=Math.sin(t+e);return[n,a,n-a*r,a+n*r,o+i*r,i-o*r,o,i]}t.exports=function(t,a,o,i,s,l,c,u,h){var f=Math.sin(h*e/360),p=Math.cos(h*e/360),d=p*(t-o)/2+f*(a-i)/2,m=-f*(t-o)/2+p*(a-i)/2;if(0===d&&0===m)return[];if(0===c||0===u)return[];c=Math.abs(c),u=Math.abs(u);var g=d*d/(c*c)+m*m/(u*u);g>1&&(c*=Math.sqrt(g),u*=Math.sqrt(g));var v=function(t,n,a,o,i,s,l,c,u,h){var f=h*(t-a)/2+u*(n-o)/2,p=-u*(t-a)/2+h*(n-o)/2,d=l*l,m=c*c,g=f*f,v=p*p,x=d*m-d*v-m*g;x<0&&(x=0),x/=d*v+m*g;var y=(x=Math.sqrt(x)*(i===s?-1:1))*l/c*p,b=x*-c/l*f,w=h*y-u*b+(t+a)/2,S=u*y+h*b+(n+o)/2,M=(f-y)/l,A=(p-b)/c,N=(-f-y)/l,k=(-p-b)/c,_=r(1,0,M,A),P=r(M,A,N,k);return 0===s&&P>0&&(P-=e),1===s&&P<0&&(P+=e),[w,S,_,P]}(t,a,o,i,s,l,c,u,f,p),x=[],y=v[2],b=v[3],w=Math.max(Math.ceil(Math.abs(b)/(e/4)),1);b/=w;for(var S=0;S<w;S++)x.push(n(y,b)),y+=b;return x.map((function(t){for(var e=0;e<t.length;e+=2){var r=t[e+0],n=t[e+1],a=p*(r*=c)-f*(n*=u),o=f*r+p*n;t[e+0]=a+v[0],t[e+1]=o+v[1]}return t}))}},954:t=>{"use strict";var e=1e-10,r=Math.PI/180;function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);this.rx=t,this.ry=e,this.ax=r}n.prototype.transform=function(t){var n=Math.cos(this.ax*r),a=Math.sin(this.ax*r),o=[this.rx*(t[0]*n+t[2]*a),this.rx*(t[1]*n+t[3]*a),this.ry*(-t[0]*a+t[2]*n),this.ry*(-t[1]*a+t[3]*n)],i=o[0]*o[0]+o[2]*o[2],s=o[1]*o[1]+o[3]*o[3],l=((o[0]-o[3])*(o[0]-o[3])+(o[2]+o[1])*(o[2]+o[1]))*((o[0]+o[3])*(o[0]+o[3])+(o[2]-o[1])*(o[2]-o[1])),c=(i+s)/2;if(l<e*c)return this.rx=this.ry=Math.sqrt(c),this.ax=0,this;var u=o[0]*o[1]+o[2]*o[3],h=c+(l=Math.sqrt(l))/2,f=c-l/2;return this.ax=Math.abs(u)<e&&Math.abs(h-s)<e?90:180*Math.atan(Math.abs(u)>Math.abs(h-s)?(h-i)/u:u/(h-s))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(h),this.ry=Math.sqrt(f)):(this.ax+=90,this.rx=Math.sqrt(f),this.ry=Math.sqrt(h)),this},n.prototype.isDegenerate=function(){return this.rx<e*this.ry||this.ry<e*this.rx},t.exports=n},480:t=>{"use strict";function e(){if(!(this instanceof e))return new e;this.queue=[],this.cache=null}e.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]||(this.cache=null,this.queue.push(t)),this},e.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},e.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},e.prototype.rotate=function(t,e,r){var n,a,o;return 0!==t&&(this.translate(e,r),n=t*Math.PI/180,a=Math.cos(n),o=Math.sin(n),this.queue.push([a,o,-o,a,0,0]),this.cache=null,this.translate(-e,-r)),this},e.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},e.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},e.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var t=1;t<this.queue.length;t++)this.cache=(e=this.cache,r=this.queue[t],[e[0]*r[0]+e[2]*r[1],e[1]*r[0]+e[3]*r[1],e[0]*r[2]+e[2]*r[3],e[1]*r[2]+e[3]*r[3],e[0]*r[4]+e[2]*r[5]+e[4],e[1]*r[4]+e[3]*r[5]+e[5]]);var e,r;return this.cache},e.prototype.calc=function(t,e,r){var n;return this.queue.length?(this.cache||(this.cache=this.toArray()),[t*(n=this.cache)[0]+e*n[2]+(r?0:n[4]),t*n[1]+e*n[3]+(r?0:n[5])]):[t,e]},t.exports=e},665:t=>{"use strict";var e={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},r=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function n(t){return t>=48&&t<=57}function a(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function o(t){for(;t.index<t.max&&(10===(e=t.path.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&r.indexOf(e)>=0);)t.index++;var e}function i(t){var e=t.path.charCodeAt(t.index);return 48===e?(t.param=0,void t.index++):49===e?(t.param=1,void t.index++):void(t.err="SvgPath: arc flag can be 0 or 1 only (at pos "+t.index+")")}function s(t){var e,r=t.index,a=r,o=t.max,i=!1,s=!1,l=!1,c=!1;if(a>=o)t.err="SvgPath: missed param (at pos "+a+")";else if(43!==(e=t.path.charCodeAt(a))&&45!==e||(e=++a<o?t.path.charCodeAt(a):0),n(e)||46===e){if(46!==e){if(i=48===e,e=++a<o?t.path.charCodeAt(a):0,i&&a<o&&e&&n(e))return void(t.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+r+")");for(;a<o&&n(t.path.charCodeAt(a));)a++,s=!0;e=a<o?t.path.charCodeAt(a):0}if(46===e){for(c=!0,a++;n(t.path.charCodeAt(a));)a++,l=!0;e=a<o?t.path.charCodeAt(a):0}if(101===e||69===e){if(c&&!s&&!l)return void(t.err="SvgPath: invalid float exponent (at pos "+a+")");if(43!==(e=++a<o?t.path.charCodeAt(a):0)&&45!==e||a++,!(a<o&&n(t.path.charCodeAt(a))))return void(t.err="SvgPath: invalid float exponent (at pos "+a+")");for(;a<o&&n(t.path.charCodeAt(a));)a++}t.index=a,t.param=parseFloat(t.path.slice(r,a))+0}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+a+")"}function l(t){var r,n;n=(r=t.path[t.segmentStart]).toLowerCase();var a=t.data;if("m"===n&&a.length>2&&(t.result.push([r,a[0],a[1]]),a=a.slice(2),n="l",r="m"===r?"l":"L"),"r"===n)t.result.push([r].concat(a));else for(;a.length>=e[n]&&(t.result.push([r].concat(a.splice(0,e[n]))),e[n]););}function c(t){var r,n,a,c,u,h,f=t.max;if(t.segmentStart=t.index,n=97==(32|(r=t.path.charCodeAt(t.index))),function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(r))if(c=e[t.path[t.index].toLowerCase()],t.index++,o(t),t.data=[],c){for(a=!1;;){for(u=c;u>0;u--){if(!n||3!==u&&4!==u?s(t):i(t),t.err.length)return void l(t);t.data.push(t.param),o(t),a=!1,t.index<f&&44===t.path.charCodeAt(t.index)&&(t.index++,o(t),a=!0)}if(!a){if(t.index>=t.max)break;if(!((h=t.path.charCodeAt(t.index))>=48&&h<=57||43===h||45===h||46===h))break}}l(t)}else l(t);else t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")"}t.exports=function(t){var e=new a(t),r=e.max;for(o(e);e.index<r&&!e.err.length;)c(e);return e.result.length&&("mM".indexOf(e.result[0][0])<0?(e.err="SvgPath: string should start with `M` or `m`",e.result=[]):e.result[0][0]="M"),{err:e.err,segments:e.result}}},192:(t,e,r)=>{"use strict";var n=r(665),a=r(94),o=r(480),i=r(921),s=r(954);function l(t){if(!(this instanceof l))return new l(t);var e=n(t);this.segments=e.segments,this.err=e.err,this.__stack=[]}l.from=function(t){if("string"==typeof t)return new l(t);if(t instanceof l){var e=new l("");return e.err=t.err,e.segments=t.segments.map((function(t){return t.slice()})),e.__stack=t.__stack.map((function(t){return o().matrix(t.toArray())})),e}throw new Error("SvgPath.from: invalid param type "+t)},l.prototype.__matrix=function(t){var e,r=this;t.queue.length&&this.iterate((function(n,a,o,i){var l,c,u,h;switch(n[0]){case"v":c=0===(l=t.calc(0,n[1],!0))[0]?["v",l[1]]:["l",l[0],l[1]];break;case"V":c=(l=t.calc(o,n[1],!1))[0]===t.calc(o,i,!1)[0]?["V",l[1]]:["L",l[0],l[1]];break;case"h":c=0===(l=t.calc(n[1],0,!0))[1]?["h",l[0]]:["l",l[0],l[1]];break;case"H":c=(l=t.calc(n[1],i,!1))[1]===t.calc(o,i,!1)[1]?["H",l[0]]:["L",l[0],l[1]];break;case"a":case"A":var f=t.toArray(),p=s(n[1],n[2],n[3]).transform(f);if(f[0]*f[3]-f[1]*f[2]<0&&(n[5]=n[5]?"0":"1"),l=t.calc(n[6],n[7],"a"===n[0]),"A"===n[0]&&n[6]===o&&n[7]===i||"a"===n[0]&&0===n[6]&&0===n[7]){c=["a"===n[0]?"l":"L",l[0],l[1]];break}c=p.isDegenerate()?["a"===n[0]?"l":"L",l[0],l[1]]:[n[0],p.rx,p.ry,p.ax,n[4],n[5],l[0],l[1]];break;case"m":h=a>0,c=["m",(l=t.calc(n[1],n[2],h))[0],l[1]];break;default:for(c=[u=n[0]],h=u.toLowerCase()===u,e=1;e<n.length;e+=2)l=t.calc(n[e],n[e+1],h),c.push(l[0],l[1])}r.segments[a]=c}),!0)},l.prototype.__evaluateStack=function(){var t,e;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=o(),e=this.__stack.length;--e>=0;)t.matrix(this.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},l.prototype.toString=function(){var t="",e="",r=!1;this.__evaluateStack();for(var n=0,a=this.segments.length;n<a;n++){var o=this.segments[n],i=o[0];i!==e||"m"===i||"M"===i?("m"===i&&"z"===e&&(t+=" "),t+=i,r=!1):r=!0;for(var s=1;s<o.length;s++){var l=o[s];1===s?r&&l>=0&&(t+=" "):l>=0&&(t+=" "),t+=l}e=i}return t},l.prototype.translate=function(t,e){return this.__stack.push(o().translate(t,e||0)),this},l.prototype.scale=function(t,e){return this.__stack.push(o().scale(t,e||0===e?e:t)),this},l.prototype.rotate=function(t,e,r){return this.__stack.push(o().rotate(t,e||0,r||0)),this},l.prototype.skewX=function(t){return this.__stack.push(o().skewX(t)),this},l.prototype.skewY=function(t){return this.__stack.push(o().skewY(t)),this},l.prototype.matrix=function(t){return this.__stack.push(o().matrix(t)),this},l.prototype.transform=function(t){return t.trim()?(this.__stack.push(a(t)),this):this},l.prototype.round=function(t){var e,r=0,n=0,a=0,o=0;return t=t||0,this.__evaluateStack(),this.segments.forEach((function(i){var s=i[0].toLowerCase()===i[0];switch(i[0]){case"H":case"h":return s&&(i[1]+=a),a=i[1]-i[1].toFixed(t),void(i[1]=+i[1].toFixed(t));case"V":case"v":return s&&(i[1]+=o),o=i[1]-i[1].toFixed(t),void(i[1]=+i[1].toFixed(t));case"Z":case"z":return a=r,void(o=n);case"M":case"m":return s&&(i[1]+=a,i[2]+=o),a=i[1]-i[1].toFixed(t),o=i[2]-i[2].toFixed(t),r=a,n=o,i[1]=+i[1].toFixed(t),void(i[2]=+i[2].toFixed(t));case"A":case"a":return s&&(i[6]+=a,i[7]+=o),a=i[6]-i[6].toFixed(t),o=i[7]-i[7].toFixed(t),i[1]=+i[1].toFixed(t),i[2]=+i[2].toFixed(t),i[3]=+i[3].toFixed(t+2),i[6]=+i[6].toFixed(t),void(i[7]=+i[7].toFixed(t));default:return e=i.length,s&&(i[e-2]+=a,i[e-1]+=o),a=i[e-2]-i[e-2].toFixed(t),o=i[e-1]-i[e-1].toFixed(t),void i.forEach((function(e,r){r&&(i[r]=+i[r].toFixed(t))}))}})),this},l.prototype.iterate=function(t,e){var r,n,a,o=this.segments,i={},s=!1,l=0,c=0,u=0,h=0;if(e||this.__evaluateStack(),o.forEach((function(e,r){var n=t(e,r,l,c);Array.isArray(n)&&(i[r]=n,s=!0);var a=e[0]===e[0].toLowerCase();switch(e[0]){case"m":case"M":return l=e[1]+(a?l:0),c=e[2]+(a?c:0),u=l,void(h=c);case"h":case"H":return void(l=e[1]+(a?l:0));case"v":case"V":return void(c=e[1]+(a?c:0));case"z":case"Z":return l=u,void(c=h);default:l=e[e.length-2]+(a?l:0),c=e[e.length-1]+(a?c:0)}})),!s)return this;for(a=[],r=0;r<o.length;r++)if(void 0!==i[r])for(n=0;n<i[r].length;n++)a.push(i[r][n]);else a.push(o[r]);return this.segments=a,this},l.prototype.abs=function(){return this.iterate((function(t,e,r,n){var a,o=t[0],i=o.toUpperCase();if(o!==i)switch(t[0]=i,o){case"v":return void(t[1]+=n);case"a":return t[6]+=r,void(t[7]+=n);default:for(a=1;a<t.length;a++)t[a]+=a%2?r:n}}),!0),this},l.prototype.rel=function(){return this.iterate((function(t,e,r,n){var a,o=t[0],i=o.toLowerCase();if(o!==i&&(0!==e||"M"!==o))switch(t[0]=i,o){case"V":return void(t[1]-=n);case"A":return t[6]-=r,void(t[7]-=n);default:for(a=1;a<t.length;a++)t[a]-=a%2?r:n}}),!0),this},l.prototype.unarc=function(){return this.iterate((function(t,e,r,n){var a,o,s,l=[],c=t[0];return"A"!==c&&"a"!==c?null:("a"===c?(o=r+t[6],s=n+t[7]):(o=t[6],s=t[7]),0===(a=i(r,n,o,s,t[4],t[5],t[1],t[2],t[3])).length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(a.forEach((function(t){l.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])})),l))})),this},l.prototype.unshort=function(){var t,e,r,n,a,o=this.segments;return this.iterate((function(i,s,l,c){var u,h=i[0],f=h.toUpperCase();s&&("T"===f?(u="t"===h,"Q"===(r=o[s-1])[0]?(t=r[1]-l,e=r[2]-c):"q"===r[0]?(t=r[1]-r[3],e=r[2]-r[4]):(t=0,e=0),n=-t,a=-e,u||(n+=l,a+=c),o[s]=[u?"q":"Q",n,a,i[1],i[2]]):"S"===f&&(u="s"===h,"C"===(r=o[s-1])[0]?(t=r[3]-l,e=r[4]-c):"c"===r[0]?(t=r[3]-r[5],e=r[4]-r[6]):(t=0,e=0),n=-t,a=-e,u||(n+=l,a+=c),o[s]=[u?"c":"C",n,a,i[1],i[2],i[3],i[4]]))})),this},t.exports=l},94:(t,e,r)=>{"use strict";var n=r(480),a={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},o=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;t.exports=function(t){var e,r,s=new n;return t.split(o).forEach((function(t){if(t.length)if(void 0===a[t])switch(r=t.split(i).map((function(t){return+t||0})),e){case"matrix":return void(6===r.length&&s.matrix(r));case"scale":return void(1===r.length?s.scale(r[0],r[0]):2===r.length&&s.scale(r[0],r[1]));case"rotate":return void(1===r.length?s.rotate(r[0],0,0):3===r.length&&s.rotate(r[0],r[1],r[2]));case"translate":return void(1===r.length?s.translate(r[0],0):2===r.length&&s.translate(r[0],r[1]));case"skewX":return void(1===r.length&&s.skewX(r[0]));case"skewY":return void(1===r.length&&s.skewY(r[0]))}else e=t})),s}},680:(t,e)=>{let r=!1,n=!1;function a(t,e){for(var r=document.createElementNS("http://www.w3.org/2000/svg",e),n=0;n<t.attributes.length;n++)r.setAttribute(t.attributes[n].nodeName,t.attributes[n].value);for(var a=t.childNodes,o=0;o<a.length;o++)r.appendChild(a[o]);return t.parentNode.replaceChild(r,t),r}function o(t,e=!1){for(var r="",n=0;n<t.length;n+=2)r+=(r.length?" ":"M")+t[n]+","+t[n+1];return e&&(r+="z"),r}function i(t,e,r){const n=document.createAttribute(e);n.value=r,t.setNamedItem(n)}function s(t){const e=t.attributes,r=e.cx.value,n=e.cy.value,o=e.rx.value,s=e.ry.value;let l="M"+(r-o)+","+n+"a"+o+","+s+" 0 1,0 "+2*o+",0a"+o+","+s+" 0 1,0 "+-2*o+",0";return e.removeNamedItem("cx"),e.removeNamedItem("cy"),e.removeNamedItem("rx"),e.removeNamedItem("ry"),i(e,"d",l),a(t,"path")}function l(t){const e=t.attributes;var r=parseFloat(e.x.value||0),n=parseFloat(e.y.value||0),s=parseFloat(e.width.value),l=parseFloat(e.height.value),c=[];c.push(r,n),c.push(r+s,n),c.push(r+s,n+l),c.push(r,n+l);var u=o(c,!0);return e.removeNamedItem("x"),e.removeNamedItem("y"),e.removeNamedItem("width"),e.removeNamedItem("height"),i(e,"d",u),a(t,"path")}e.pathify=function(t,e=!1){t.querySelectorAll("*").forEach((function(t){switch(t.tagName){case"ellipse":e&&t.closest('[layer="Symbol"]')&&s(t);break;case"circle":!function(t){const e=t.attributes,r=(e.cx.value,e.cy.value,e.r.value);e.removeNamedItem("r"),i(e,"rx",r),i(e,"ry",r),a(t,"ellipse")}(t);break;case"image":console.log("*WARNING*: <image> is removed!"),r||(alert("*WARNING*: <image> is removed!\nHave a look at the console log for details!"),r=!0),t.parentNode.removeChild(t);break;case"rect":l(t);break;case"switch":!function(t){const e=t.children;if(2!==e.length||"foreignObject"!==e[0].tagName||"http://www.w3.org/TR/SVG11/feature#Extensibility"!==e[0].attributes.requiredFeatures.value||"text"!==e[1].tagName)2!==e.length||"g"!==e[0].tagName||"http://www.w3.org/TR/SVG11/feature#Extensibility"!==e[0].attributes.requiredFeatures.value||"a"!==e[1].tagName?(console.log("*WARNING*: unsupported <switch> tag"),n||(alert("*WARNING*: unsupported <switch> tag\nHave a look at the console log for details!"),n=!0)):t.parentNode.removeChild(t);else{const r=e[0],n=e[1];if(r.querySelector("font")){const t=r.querySelector("font").style.fontSize;n.attributes["font-size"].value=t}t.parentNode.replaceChild(n,t)}}(t)}}))},e.transformTag=a,e.addAttribute=i,e.createPath=o,e.convertRectToPath=l,e.convertEllipseToPath=s},612:(t,e,r)=>{"use strict";var n=Uint8Array,a=Uint16Array,o=Uint32Array,i=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var r=new a(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];var i=new o(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},u=c(i,2),h=u[0],f=u[1];h[28]=258,f[258]=28;for(var p=c(s,0),d=(p[0],p[1]),m=new a(32768),g=0;g<32768;++g){var v=(43690&g)>>>1|(21845&g)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,m[g]=((65280&v)>>>8|(255&v)<<8)>>>1}var x=function(t,e,r){for(var n=t.length,o=0,i=new a(e);o<n;++o)t[o]&&++i[t[o]-1];var s,l=new a(e);for(o=0;o<e;++o)l[o]=l[o-1]+i[o-1]<<1;if(r){s=new a(1<<e);var c=15-e;for(o=0;o<n;++o)if(t[o])for(var u=o<<4|t[o],h=e-t[o],f=l[t[o]-1]++<<h,p=f|(1<<h)-1;f<=p;++f)s[m[f]>>>c]=u}else for(s=new a(n),o=0;o<n;++o)t[o]&&(s[o]=m[l[t[o]-1]++]>>>15-t[o]);return s},y=new n(288);for(g=0;g<144;++g)y[g]=8;for(g=144;g<256;++g)y[g]=9;for(g=256;g<280;++g)y[g]=7;for(g=280;g<288;++g)y[g]=8;var b=new n(32);for(g=0;g<32;++g)b[g]=5;var w=x(y,9,0),S=x(b,5,0),M=function(t){return(t+7)/8|0},A=function(t,e,r){(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length);var i=new(2==t.BYTES_PER_ELEMENT?a:4==t.BYTES_PER_ELEMENT?o:n)(r-e);return i.set(t.subarray(e,r)),i},N=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(t,e,r){var n=new Error(e||N[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,k),!r)throw n;return n},_=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8},P=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8,t[n+2]|=r>>>16},C=function(t,e){for(var r=[],o=0;o<t.length;++o)t[o]&&r.push({s:o,f:t[o]});var i=r.length,s=r.slice();if(!i)return[F,0];if(1==i){var l=new n(r[0].s+1);return l[r[0].s]=1,[l,1]}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var c=r[0],u=r[1],h=0,f=1,p=2;for(r[0]={s:-1,f:c.f+u.f,l:c,r:u};f!=i-1;)c=r[r[h].f<r[p].f?h++:p++],u=r[h!=f&&r[h].f<r[p].f?h++:p++],r[f++]={s:-1,f:c.f+u.f,l:c,r:u};var d=s[0].s;for(o=1;o<i;++o)s[o].s>d&&(d=s[o].s);var m=new a(d+1),g=E(r[f-1],m,0);if(g>e){o=0;var v=0,x=g-e,y=1<<x;for(s.sort((function(t,e){return m[e.s]-m[t.s]||t.f-e.f}));o<i;++o){var b=s[o].s;if(!(m[b]>e))break;v+=y-(1<<g-m[b]),m[b]=e}for(v>>>=x;v>0;){var w=s[o].s;m[w]<e?v-=1<<e-m[w]++-1:++o}for(;o>=0&&v;--o){var S=s[o].s;m[S]==e&&(--m[S],++v)}g=e}return[new n(m),g]},E=function(t,e,r){return-1==t.s?Math.max(E(t.l,e,r+1),E(t.r,e,r+1)):e[t.s]=r},V=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new a(++e),n=0,o=t[0],i=1,s=function(t){r[n++]=t},l=1;l<=e;++l)if(t[l]==o&&l!=e)++i;else{if(!o&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(o),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(o);i=1,o=t[l]}return[r.subarray(0,n),e]},T=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},G=function(t,e,r){var n=r.length,a=M(e+2);t[a]=255&n,t[a+1]=n>>>8,t[a+2]=255^t[a],t[a+3]=255^t[a+1];for(var o=0;o<n;++o)t[a+o+4]=r[o];return 8*(a+4+n)},q=function(t,e,r,n,o,c,u,h,f,p,d){_(e,d++,r),++o[256];for(var m=C(o,15),g=m[0],v=m[1],M=C(c,15),A=M[0],N=M[1],k=V(g),E=k[0],q=k[1],I=V(A),F=I[0],R=I[1],$=new a(19),D=0;D<E.length;++D)$[31&E[D]]++;for(D=0;D<F.length;++D)$[31&F[D]]++;for(var z=C($,7),L=z[0],O=z[1],B=19;B>4&&!L[l[B-1]];--B);var U,H,W,j,Y=p+5<<3,X=T(o,y)+T(c,b)+u,Z=T(o,g)+T(c,A)+u+14+3*B+T($,L)+(2*$[16]+3*$[17]+7*$[18]);if(Y<=X&&Y<=Z)return G(e,d,t.subarray(f,f+p));if(_(e,d,1+(Z<X)),d+=2,Z<X){U=x(g,v,0),H=g,W=x(A,N,0),j=A;var Q=x(L,O,0);for(_(e,d,q-257),_(e,d+5,R-1),_(e,d+10,B-4),d+=14,D=0;D<B;++D)_(e,d+3*D,L[l[D]]);d+=3*B;for(var J=[E,F],K=0;K<2;++K){var tt=J[K];for(D=0;D<tt.length;++D){var et=31&tt[D];_(e,d,Q[et]),d+=L[et],et>15&&(_(e,d,tt[D]>>>5&127),d+=tt[D]>>>12)}}}else U=w,H=y,W=S,j=b;for(D=0;D<h;++D)if(n[D]>255){et=n[D]>>>18&31,P(e,d,U[et+257]),d+=H[et+257],et>7&&(_(e,d,n[D]>>>23&31),d+=i[et]);var rt=31&n[D];P(e,d,W[rt]),d+=j[rt],rt>3&&(P(e,d,n[D]>>>5&8191),d+=s[rt])}else P(e,d,U[n[D]]),d+=H[n[D]];return P(e,d,U[256]),d+H[256]},I=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new n(0),R=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,n=9;--n;)r=(1&r&&-306674912)^r>>>1;t[e]=r}return t}(),$=function(){var t=-1;return{p:function(e){for(var r=t,n=0;n<e.length;++n)r=R[255&r^e[n]]^r>>>8;t=r},d:function(){return~t}}},D=function(t,e,r,l,c){return function(t,e,r,l,c,u){var h=t.length,p=new n(l+h+5*(1+Math.ceil(h/7e3))+c),m=p.subarray(l,p.length-c),g=0;if(!e||h<8)for(var v=0;v<=h;v+=65535){var x=v+65535;x>=h&&(m[g>>3]=u),g=G(m,g+1,t.subarray(v,x))}else{for(var y=I[e-1],b=y>>>13,w=8191&y,S=(1<<r)-1,N=new a(32768),k=new a(S+1),_=Math.ceil(r/3),P=2*_,C=function(e){return(t[e]^t[e+1]<<_^t[e+2]<<P)&S},E=new o(25e3),V=new a(288),T=new a(32),R=0,$=0,D=(v=0,0),z=0,L=0;v<h;++v){var O=C(v),B=32767&v,U=k[O];if(N[B]=U,k[O]=B,z<=v){var H=h-v;if((R>7e3||D>24576)&&H>423){g=q(t,m,0,E,V,T,$,D,L,v-L,g),D=R=$=0,L=v;for(var W=0;W<286;++W)V[W]=0;for(W=0;W<30;++W)T[W]=0}var j=2,Y=0,X=w,Z=B-U&32767;if(H>2&&O==C(v-Z))for(var Q=Math.min(b,H)-1,J=Math.min(32767,v),K=Math.min(258,H);Z<=J&&--X&&B!=U;){if(t[v+j]==t[v+j-Z]){for(var tt=0;tt<K&&t[v+tt]==t[v+tt-Z];++tt);if(tt>j){if(j=tt,Y=Z,tt>Q)break;var et=Math.min(Z,tt-2),rt=0;for(W=0;W<et;++W){var nt=v-Z+W+32768&32767,at=nt-N[nt]+32768&32767;at>rt&&(rt=at,U=nt)}}}Z+=(B=U)-(U=N[B])+32768&32767}if(Y){E[D++]=268435456|f[j]<<18|d[Y];var ot=31&f[j],it=31&d[Y];$+=i[ot]+s[it],++V[257+ot],++T[it],z=v+j,++R}else E[D++]=t[v],++V[t[v]]}}g=q(t,m,u,E,V,T,$,D,L,v-L,g),!u&&7&g&&(g=G(m,g+1,F))}return A(p,0,l+M(g)+c)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,r,l,!c)},z=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},L=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8};function O(t,e){return D(t,e||{},0,0)}var B=function(t,e,r,a){for(var o in t){var i=t[o],s=e+o,l=a;Array.isArray(i)&&(l=z(a,i[1]),i=i[0]),i instanceof n?r[s]=[i,l]:(r[s+="/"]=[new n(0),l],B(i,s,r,a))}},U="undefined"!=typeof TextEncoder&&new TextEncoder,H="undefined"!=typeof TextDecoder&&new TextDecoder;try{H.decode(F,{stream:!0})}catch(t){}function W(t,e){if(e){for(var r=new n(t.length),a=0;a<t.length;++a)r[a]=t.charCodeAt(a);return r}if(U)return U.encode(t);var o=t.length,i=new n(t.length+(t.length>>1)),s=0,l=function(t){i[s++]=t};for(a=0;a<o;++a){if(s+5>i.length){var c=new n(s+8+(o-a<<1));c.set(i),i=c}var u=t.charCodeAt(a);u<128||e?l(u):u<2048?(l(192|u>>6),l(128|63&u)):u>55295&&u<57344?(l(240|(u=65536+(1047552&u)|1023&t.charCodeAt(++a))>>18),l(128|u>>12&63),l(128|u>>6&63),l(128|63&u)):(l(224|u>>12),l(128|u>>6&63),l(128|63&u))}return A(i,0,s)}var j=function(t){var e=0;if(t)for(var r in t){var n=t[r].length;n>65535&&k(9),e+=n+4}return e},Y=function(t,e,r,n,a,o,i,s){var l=n.length,c=r.extra,u=s&&s.length,h=j(c);L(t,e,null!=i?33639248:67324752),e+=4,null!=i&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(o<0&&8),t[e++]=a&&8,t[e++]=255&r.compression,t[e++]=r.compression>>8;var f=new Date(null==r.mtime?Date.now():r.mtime),p=f.getFullYear()-1980;if((p<0||p>119)&&k(10),L(t,e,p<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>>1),e+=4,-1!=o&&(L(t,e,r.crc),L(t,e+4,o<0?-o-2:o),L(t,e+8,r.size)),L(t,e+12,l),L(t,e+14,h),e+=16,null!=i&&(L(t,e,u),L(t,e+6,r.attrs),L(t,e+10,i),e+=14),t.set(n,e),e+=l,h)for(var d in c){var m=c[d],g=m.length;L(t,e,+d),L(t,e+2,g),t.set(m,e+4),e+=4+g}return u&&(t.set(s,e),e+=u),e};function X(t,e){e||(e={});var r={},a=[];B(t,"",r,e);var o=0,i=0;for(var s in r){var l=r[s],c=l[0],u=l[1],h=0==u.level?0:8,f=(A=W(s)).length,p=u.comment,d=p&&W(p),m=d&&d.length,g=j(u.extra);f>65535&&k(11);var v=h?O(c,u):c,x=v.length,y=$();y.p(c),a.push(z(u,{size:c.length,crc:y.d(),c:v,f:A,m:d,u:f!=s.length||d&&p.length!=m,o,compression:h})),o+=30+f+g+x,i+=76+2*(f+g)+(m||0)+x}for(var b=new n(i+22),w=o,S=i-o,M=0;M<a.length;++M){var A=a[M];Y(b,A.o,A,A.f,A.u,A.c.length);var N=30+A.f.length+j(A.extra);b.set(A.c,A.o+N),Y(b,o,A,A.f,A.u,A.c.length,A.o,A.m),o+=16+N+(A.m?A.m.length:0)}return function(t,e,r,n,a){L(t,e,101010256),L(t,e+8,r),L(t,e+10,r),L(t,e+12,n),L(t,e+16,a)}(b,o,a.length,S,w),b}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;const Z=r(957);Draw.loadPlugin((function(t){console.log("Draw.loadPlugin: 'SVG bulk export'");const e="svg_bulk_export.js",r=new RegExp(/^[a-zA-Z]:\\(((?![<>:"/\\|?*]).)+((?<![ .])\\)?)*$/),n=function(){console.log("start fix_plugin_path...");const t=mxSettings.getPlugins();console.log("plugins:",t);const r=t.findIndex((t=>t.endsWith(e))),n=t[r];return t[r]=e,console.log("...end fix_plugin_path"),n}();(async function(){console.log("plugin: ",n);let t=n.substring(0,n.lastIndexOf("."))+".config.json";console.log("path to json configuration file:",t),t.startsWith("file:")||(t="file:///"+t);const e=await fetch(t),r=await e.json();return console.log("loaded json config:",r),r})().then((e=>{function n(e){const r=t.currentPage;try{return t.selectPage(e),i()}catch(t){console.log("error:",t)}finally{t.selectPage(r)}}function a(){const e=t.getCurrentFile().fileObject.path,r=e.substring(0,e.lastIndexOf("\\")+1),n=e.substring(e.lastIndexOf("\\")+1),a=n.substring(0,n.lastIndexOf(".")),o=n.substring(n.lastIndexOf(".")+1);return{path:e,dirname:r,filename:n,basename:a,extension:o}}function o(t){return"string"==typeof t.value?t.value:t.value.attributes.label.value}function i(){console.log(`exportCurrentPage: ${t.currentPage.getName()}`,t.currentPage);var n=t.editor.graph,i=n.getModel(),s=i.getChildren(i.root),l=s.map((t=>o(t)));console.log("layers: ",l);var c=s.filter((t=>t.visible)).map((t=>o(t)));console.log("enabled layers: ",c);var u=l.filter((t=>t.startsWith("Option")));console.log("optionLayers:",u);const h=[];try{for(const[l,c]of Object.entries(e.layerGroups)){console.log(`layer group: ${l}`,c);var f=c.exportPerOptionLayer?u:[""];for(const u of f){for(const t of s){const e=o(t);var p=c.enabledLayers.includes(e)||e===u;i.setVisible(t,p)}const f=n.getSvg();let x=`${Graph.xmlDeclaration}\n${Graph.svgDoctype}\n${mxUtils.getXml(f)}`;if(e.cleanup.enabled){var d,m,g;const t=s.filter((t=>"Symbol"==o(t)))[0];try{g=t.getAttribute("UoM"),d=t.getAttribute("Width"),m=t.getAttribute("Height")}catch{console.error("Error extracting dimension values from symbol layer.")}if(!d||!m||!g){const t=s.filter((t=>"Dimension"==o(t)))[0];try{for(const e of t.children){const t=e.getAttribute("Dimension");g=e.getAttribute("UoM");const r=e.getAttribute("Value");switch(t){case"W":d=r;break;case"H":m=r}}}catch{console.error("Error extracting dimension values from dimension layer.")}}d&&m&&g||alert("Error extracting dimension values from symbol or dimension layer."),"mm"!==g&&alert(`Unsupported UoM: ${g}. Only the unit of measure 'mm' is supported.`),x=Z.clean_svg(x,d,m,c.GridLayer,c.DimensionLayer,e)}const y=a(),b="filenamePostfix"in c?c.filenamePostfix:`_${u||l}`,w=`${e.addDrawIOFilenameAsPrefix?y.basename+"-":""}${t.currentPage.getName()}${b}.svg`;var v=y.dirname;c.exportPath&&(r.test(c.exportPath)?v=`${c.exportPath}\\`:v+=`\\${c.exportPath}\\`),h.push({exportPath:c.exportPath?c.exportPath:"",filename:w,filePath:`${v}${w}`,svg_xml:x,dirname:v})}}return h}catch(t){console.log("error:",t)}finally{for(const t of s)p=c.includes(o(t)),i.setVisible(t,p)}}function s(t){if(!("writeToFileSystem"in e)||e.writeToFileSystem)for(const e of t)console.log(`export file: ${e}`),electron.request({action:"writeFile",path:e.filePath,data:e.svg_xml,enc:"utf-8"},(()=>{}),(t=>{const r=`An error occured while writing the file '${e.filePath}':\n\n${t}\n\nDoes the directory '${e.dirname}' exist?`;console.log(r),alert(r)}));if(e.zipFilePath){const n={};for(const e of t)n[e.exportPath?`${e.exportPath.replace(":","")}/${e.filename}`:e.filename]=W(e.svg_xml);console.log(n);const o=X(n),i=a(),s=e.zipFilePath,l=r.test(s)?s:`${i.dirname}${s}`;electron.request({action:"writeFile",path:l,data:o,enc:"utf-8"},(()=>{const t=`The zip file for svg bulk export has been written to:\n\n${l}`;console.log(t)}),(t=>{console.log(t),alert(t)}))}}e.openDevTools&&(console.log("open dev tools..."),electron.sendMessage("openDevTools")),console.log("init: 'SVG bulk export - Single symbol'"),mxResources.parse("export_single_symbol=SVG bulk export - Single symbol"),t.actions.addAction("export_single_symbol",(function(){console.log("*** SVG bulk export - Single symbol ***"),setTimeout((()=>t.spinner.spin(document.body,mxResources.get("export_single_symbol"))),0),setTimeout((()=>{try{s(i())}catch(e){t.handleError(e)}finally{t.spinner.stop()}}),50)})),console.log("init: 'SVG bulk export - All symbols'"),mxResources.parse("export_all_symbols=SVG bulk export - All symbols"),t.actions.addAction("export_all_symbols",(function(){setTimeout((()=>t.spinner.spin(document.body,mxResources.get("export_all_symbols"))),0),setTimeout((()=>{try{console.log("*** SVG bulk export - All symbols ***");var e=t.pages;if(e.length>0){console.log(`exporting ${e.length} pages`);const t=[];for(let r=0;r<e.length;r++){const a=e[r];t.push.apply(t,n(a))}s(t)}else t.alert(mxResources.get("nothingIsSelected"))}catch(e){t.handleError(e)}finally{t.spinner.stop()}}),50)})),console.log("init: 'SVG bulk export - Create zip file with folder structure'"),mxResources.parse("create_zip_file=SVG bulk export - Create zip file with folder structure"),t.actions.addAction("create_zip_file",(function(){console.log("*** SVG bulk export - Create zip file with folder structure ***"),setTimeout((()=>t.spinner.spin(document.body,mxResources.get("create_zip_file"))),0),setTimeout((()=>{try{const n=a();console.log("currentFileInfo:",n);const o=Object.entries(e.layerGroups).filter((t=>t[1].exportPath&&!r.test(t[1].exportPath))).map((t=>[t[1].exportPath,{}])),i=Object.fromEntries(o);console.log("folders:",i);const s=X(i);console.log("zipped: ",s);const l=`${n.dirname}svg_bulk_export_folders.zip`;electron.request({action:"writeFile",path:l,data:s,enc:"utf-8"},(()=>{alert(`The zip file containing the folder structure for svg bulk export has been written to:\n\n${l}`)}),(t=>{console.log(t),alert(t)}))}catch(t){console.log("error:",t)}finally{t.spinner.stop()}}),50)}));var l=t.menus.get("extras"),c=l.funct;l.funct=function(e,r){c.apply(this,arguments),t.menus.addMenuItems(e,["-","export_single_symbol","export_all_symbols","create_zip_file"],r)};var u=Graph.prototype.createSvgImageExport;Graph.prototype.createSvgImageExport=function(){var t=u.apply(this,arguments),e=t.drawCellState;return t.drawCellState=function(t,r){var n=r.root.ownerDocument,a=null!=n.createElementNS?n.createElementNS(mxConstants.NS_SVG,"g"):n.createElement("g");a.setAttribute("id","cell-"+t.cell.id);var i=r.root;if(i.appendChild(a),r.root=a,e.apply(this,arguments),null==a.firstChild)a.parentNode.removeChild(a);else{if(mxUtils.isNode(t.cell.value)){a.setAttribute("content",mxUtils.getXml(t.cell.value));for(var s=0;s<t.cell.value.attributes.length;s++){var l=t.cell.value.attributes[s];a.setAttribute("data-"+l.name,l.value)}}for(var c=t.cell;null!==c.parent.parent;)c=c.parent;const e=o(c);a.setAttribute("layer",e)}r.root=i},t}}))}))},957:(t,e,r)=>{t=r.nmd(t),r(462);const n=r(721),a=r(680),o=document.createElementNS("http://www.w3.org/2000/svg","svg");let i=!1,s=!1;function l(t,e){const r=t.parentNode;var n=document.createElement("span");n.style.visibility="hidden",document.body.appendChild(n),n.appendChild(t);const a=e.getBBox({fill:!1,stroke:!1,markers:!1,clipped:!1});return document.body.removeChild(n),n.removeChild(t),r.appendChild(t),a}function c(t,e){const r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"x",e.x),r.setAttributeNS(null,"y",e.y),r.setAttributeNS(null,"width",e.width),r.setAttributeNS(null,"height",e.height),r.setAttributeNS(null,"fill","none"),r.setAttributeNS(null,"stroke","rgb(255, 0, 0)"),t.appendChild(r),a.convertRectToPath(r)}function u(t){var e=[o.createSVGPoint(),o.createSVGPoint(),o.createSVGPoint(),o.createSVGPoint()];return e[0].x=t.x,e[0].y=t.y,e[1].x=t.x+t.width,e[1].y=t.y,e[2].x=t.x+t.width,e[2].y=t.y+t.height,e[3].x=t.x,e[3].y=t.y+t.height,e}function h(t){var e=1/0,r=-1/0,n=1/0,a=-1/0;t.forEach((function(t){e=Math.min(e,t.x),r=Math.max(r,t.x),n=Math.min(n,t.y),a=Math.max(a,t.y)}));const i=o.createSVGRect();return i.x=e,i.width=r-e,i.y=n,i.height=a-n,i}function f(t,e){return h(u(t).map((t=>t.matrixTransform(e))))}function p(t){const e=t;return 1===e.a&&0===e.c&&0===e.e&&0===e.b&&1===e.d&&0===e.f}function m(t,e,r,o){const s=[t],l=[];for(;s.length;){let c=s.pop();for(;c.parentElement&&c.parentElement!==l[l.length-1];)l.pop();if(l.push(c),c.children.length){const t=c.children;for(const e of t)s.push(e)}else{const s=[];let u=t.createSVGMatrix();if(e&&(u=u.translate(-e.x,-e.y)),r){u=u.scale(r,r);const t=c.attributes;a.addAttribute(t,"vector-effect","non-scaling-stroke")}for(const t of l)if(t.transform?.baseVal?.length)for(const e of t.transform.baseVal)s.push(e),u=u.multiply(e.matrix);if(p(u))continue;switch(c.tagName){case"ellipse":case"text":if("ellipse"===c.tagName)for(const t of s)t.type===t.SVG_TRANSFORM_SCALE&&alert("WARNING: ellipse contains a scale transformation");c.transform.baseVal.clear();let a=!0;if("ellipse"===c.tagName){a=!1;const e=c.attributes;let r=t.createSVGMatrix();r=r.translate(e.cx.value,e.cy.value),r=r.scaleNonUniform(e.rx.value,e.ry.value),r=u.multiply(r);const n=(t,e,r,n)=>{try{const a=1/(t*n-e*r),o=a*n,i=-a*e,s=-a*r,l=a*t,c=o*o+s*s,u=o*i+s*l,h=i*i+l*l,f=.5*(c+h),p=(f*f-(c*h-u*u))**.5,d=f-p,m=u,g=d-c;return{ok:!0,rx:d**-.5,ry:(f+p)**-.5,alpha:(Math.atan2(g,m)*(180/Math.PI)%180+180)%180}}catch(t){return alert(`adding transformations for ellipse failed:\n\n${t}`),{ok:!1,rx:0,ry:0,alpha:0}}};let{ok:i,rx:s,ry:l,alpha:h}=n(r.a,r.c,r.b,r.d);if(i){e.cx.value=0,e.cy.value=0;const n=10**o;if(e.rx.value=Math.round(s*n)/n,e.ry.value=Math.round(l*n)/n,0!==h){let e=t.createSVGTransform();e.setRotate(h,0,0),c.transform.baseVal.insertItemBefore(e,0)}svgTransform=t.createSVGTransform(),svgTransform.setTranslate(r.e,r.f),c.transform.baseVal.insertItemBefore(svgTransform,0)}else a=!0}if(a){for(const t of s.reverse())c.transform.baseVal.insertItemBefore(t,0);if(e){const r=t.createSVGTransform();r.setTranslate(-e.x,-e.y),c.transform.baseVal.insertItemBefore(r,0)}if(r){const e=t.createSVGTransform();e.setScale(r,r),c.transform.baseVal.insertItemBefore(e,0)}}break;case"path":const l=u;c.attributes.d.value=n(c.attributes.d.value).matrix([l.a,l.b,l.c,l.d,l.e,l.f]).toString();break;case"polygon":const h=c.attributes.points.value.trim().split(/[\s,]+/),f=[];for(let e=0;e<h.length;e+=2){let r=t.createSVGPoint();r.x=h[e],r.y=h[e+1],r=r.matrixTransform(u),f.push(r.x),f.push(r.y)}c.attributes.points.value=f.join(" ");break;case"g":c.attributes.requiredFeatures||alert(`ERROR: unknown element '${c.tagName}'`);break;case"defs":break;case"rect":i||(alert("*ERROR*: rect should have been pathified!\nHave a look at the console log for details!"),i=!0);break;default:alert(`ERROR: unknown element '${c.tagName}'`)}}}t.querySelectorAll("*").forEach((function(t){["ellipse","text"].includes(t.tagName)||t.transform?.baseVal&&t.transform.baseVal.clear()}))}function g(t,e,r,n,a="none"){const o=document.createElementNS("http://www.w3.org/2000/svg","ellipse");return o.setAttributeNS(null,"cx",t),o.setAttributeNS(null,"cy",e),o.setAttributeNS(null,"rx",r),o.setAttributeNS(null,"ry",r),o.setAttributeNS(null,"fill",a),o.setAttributeNS(null,"stroke",n),o.setAttributeNS(null,"vector-effect","non-scaling-stroke"),o}function v(t,e,r,n,o,i=!1){for(;t.firstChild;)t.removeChild(t.firstChild);const s=g(e,r,n,o);t.appendChild(s),i&&a.convertEllipseToPath(s)}e.clean_svg=(t,e,r,i,p,x)=>{x.cleanup.unitScaling.uniformScaleEpsilon||(x.cleanup.unitScaling.uniformScaleEpsilon=.001),x.cleanup.roundFractionDigits||(x.cleanup.roundFractionDigits=13);const y=(new DOMParser).parseFromString(t,"image/svg+xml"),b=y.documentElement;a.pathify(y,x.cleanup.enabled&&x.cleanup.ellipseAsPath),function(t){Array.from(t.querySelectorAll("*")).some((t=>(t=>{if(t.transform?.baseVal?.length)for(const e of t.transform.baseVal)if(e.type===e.SVG_TRANSFORM_SCALE&&Math.abs(e.matrix.a)!==Math.abs(e.matrix.d))return!0;return!1})(t)))&&alert("WARNING: Non-uniform scaling is not supported.")}(b);var w=b.querySelectorAll('[layer="Origo"]'),S=null;if(1==w.length?S=w[0]:w.length&&(1==(w=Array.from(w).filter((t=>t.matches('[data-label="origo"]')))).length?S=w[0]:w.length&&alert("ERROR: unexpected number of origo nodes")),S){const t=function(t){let e=o.createSVGMatrix(),r=t;for(;r;){if(r.transform?.baseVal?.length)for(const t of r.transform.baseVal)e=t.matrix.multiply(e);r=r.parentElement}return e}(S),e=l(b,S);var M=b.createSVGPoint();M.x=Math.round(e.x+e.width/2),M.y=Math.round(e.y+e.height/2),M=M.matrixTransform(t),console.log("origo",S,e,M.x,M.y);const r=b.viewBox.baseVal;r.x=r.x-M.x,r.y=r.y-M.y,!x.cleanup.enabled||x.cleanup.unitScaling.enabled&&x.cleanup.origoCircle||(radius=Math.round(Math.max(e.width,Math.max(e.height))/2),color=x.cleanup?.origoCircle?.color??"#ff0000",v(S,M.x,M.y,radius,color,!1))}if(m(b,M,null,x.cleanup.roundFractionDigits),x.cleanup.unitScaling.addDebugBboxes||x.cleanup.unitScaling.enabled&&e&&r){const t=[];b.querySelectorAll("ellipse").forEach((function(e){let r=e.attributes;const o=r.cx.value,i=r.cy.value,s=r.rx.value,l=r.ry.value;let c="M"+(o-s)+","+i+"a"+s+","+l+" 0 1,0 "+2*s+",0a"+s+","+l+" 0 1,0 "+-2*s+",0";if(r.transform?.value){const t=r.transform.value;c=n(c).transform(t).toString()}let u=a.transformTag(e,"path");t.push([e,u]),r=u.attributes,r.removeNamedItem("cx"),r.removeNamedItem("cy"),r.removeNamedItem("rx"),r.removeNamedItem("ry"),r.transform&&r.removeNamedItem("transform"),a.addAttribute(r,"d",c)}));const o=b.querySelectorAll('[layer="Symbol"]');if(o.length>0){if(x.cleanup.sendSymbolLayerToBack)for(const t of o){const e=t.parentNode;e.removeChild(t),e.prepend(t)}const y=[];for(const t of o){const e=l(b,t);let r=u(e);y.push(...r),x.cleanup.unitScaling.addDebugBboxes&&c(b,e)}for(const e of t){const t=e[0],r=e[1];r.parentNode.replaceChild(t,r)}const w=h(y);if(x.cleanup.unitScaling.addDebugBboxes&&c(b,w),x.cleanup.unitScaling.enabled){const t=e/w.width,c=r/w.height;if(console.log("symbolLayer scale",o,w,e,r,t,c),x.cleanup.unitScaling.enabled){if(Math.abs(t-c)<x.cleanup.unitScaling.uniformScaleEpsilon){const o=.5*(t+c),s=b.viewBox.baseVal,u=b.createSVGMatrix().scale(o),h=f(s,u);if(s.x=h.x,s.y=h.y,s.width=h.width,s.height=h.height,m(b,null,o,x.cleanup.roundFractionDigits),x.cleanup.unitScaling.roundViewBox){const t={x:s.x-Math.floor(s.x),y:s.y-Math.floor(s.y)};s.x=Math.floor(s.x),s.y=Math.floor(s.y),s.width=Math.ceil(s.width+t.x),s.height=Math.ceil(s.height+t.y)}if(p){const t=x.cleanup.unitScaling.dimensions.padding;let o=document.createElementNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"layer",p),b.append(o);const i=f(w,u),c=(t,e,r,n,a,o,i)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttributeNS(null,"x",t),s.setAttributeNS(null,"y",e),s.setAttributeNS(null,"font-size",r),s.setAttributeNS(null,"font-family","Helvetica"),s.setAttributeNS(null,"text-anchor",n),s.setAttributeNS(null,"fill",o),i&&s.setAttributeNS(null,"transform",`rotate(-90 ${t} ${e})`);const l=document.createTextNode(a);return s.appendChild(l),s},h=(t,o,i,s,u)=>{const h=.7,f=.35,p=x.cleanup.unitScaling.dimensions?.color??"#77777",d=u?`H: ${r}`:`W: ${e}`;let m=c(0,0,"0.2mm","middle",d,p,!1);s.append(m);const g=l(b,m);s.removeChild(m);const v=g.width<i-2*Math.ceil(h);let y;if(m=u?c(t-.1,v?o+.5*i+.2:o-1-.5*Math.ceil(g.width),"0.2mm","middle",d,p,u):c(v?t+.5*i:t+i+1+.5*Math.ceil(g.width),o-.1,"0.2mm","middle",d,p,u),s.append(m),v)y=a.createPath([t,o,t+i,o]),y+=" "+a.createPath([t,o,t+h,o-f]),y+=" "+a.createPath([t,o,t+h,o+f]),y+=" "+a.createPath([t+i,o,t+i-h,o-f]),y+=" "+a.createPath([t+i,o,t+i-h,o+f]);else{const e=u?1+Math.ceil(g.width):1,r=u?1:1+Math.ceil(g.width);y=a.createPath([t-e,o,t+i+r,o]),y+=" "+a.createPath([t,o,t-h,o-f]),y+=" "+a.createPath([t,o,t-h,o+f]),y+=" "+a.createPath([t+i,o,t+i+h,o-f]),y+=" "+a.createPath([t+i,o,t+i+h,o+f])}const w=.7+.1;if(y+=" "+a.createPath([t,o+.5*w,t,o-.5*w]),y+=" "+a.createPath([t+i,o+.5*w,t+i,o-.5*w]),u){let e=b.createSVGTransform();e.setRotate(90,t,o);const r=e.matrix;y=n(y).matrix([r.a,r.b,r.c,r.d,r.e,r.f]).toString()}const S=document.createElementNS("http://www.w3.org/2000/svg","path");S.setAttributeNS(null,"d",y),S.setAttributeNS(null,"stroke",p),S.setAttributeNS(null,"vector-effect","non-scaling-stroke"),s.appendChild(S)};let d=i.x,m=2,g=s.y-(t?.y??0)-1,v=i.width;h(d,g,v,o,!1),d=s.x-(t?.x??0)-1,g=i.y;let y=m;v=i.height,h(d,g,v,o,!0),s.y=s.y-m,s.height=s.height+m,s.x=s.x-y,s.width=s.width+y,t&&(s.x=s.x-t.x,s.y=s.y-t.y,s.width=s.width+2*t.x,s.height=s.height+2*t.y);const S=l(b,o);s.x=Math.min(s.x,Math.floor(S.x)),s.width=Math.max(s.width,Math.ceil(S.width)),s.y=Math.min(s.y,Math.floor(S.y)),s.height=Math.max(s.height,Math.ceil(S.height))}if(i&&x.cleanup.grid.padding){const t=x.cleanup.grid.padding;s.x=s.x-t.x,s.y=s.y-t.y,s.width=s.width+2*t.x,s.height=s.height+2*t.y}x.cleanup.unitScaling.millimetersModelToDisplay&&(b.width.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_MM,s.width*x.cleanup.unitScaling.millimetersModelToDisplay),b.height.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_MM,s.height*x.cleanup.unitScaling.millimetersModelToDisplay))}else s||(alert(`*WARNING*: Non-uniform scaling is not supported.\nThus global scale is ignored.\n\nscaleX: ${t}\nscaleY: ${c}\n\nHave a look at the console log for details!`),s=!0);if(S&&x.cleanup.origoCircle&&v(S,0,0,x.cleanup.origoCircle.radius,x.cleanup.origoCircle.color??"#ff0000",!1),x.cleanup.connectionCircle){const t=x.cleanup.connectionCircle.radius,e=x.cleanup.connectionCircle.color??"#00ff00",r=x.cleanup.connectionCircle.direction?.radius??.1*t,n=x.cleanup.connectionCircle.direction?.fill??"#ff0000";var A=b.querySelectorAll('[layer="Connection"]');for(connection of A){const a=l(b,connection),o=a.x+a.width/2,i=a.y+a.height/2;if(v(connection,o,i,t,e,!1),x.cleanup.connectionCircle.direction){const e=Number(connection.attributes["data-Direction"].value);if(!isNaN(e)){let a=b.createSVGPoint();a.x=o+t,a.y=i;let s=b.createSVGTransform();s.setRotate(e,o,i),a=a.matrixTransform(s.matrix);const l=g(a.x,a.y,r,"none",n);connection.appendChild(l)}}}}if(i){console.log(`add grid layer: '${i}'`);const t=b.viewBox.baseVal;console.log(t);let e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttributeNS(null,"layer",i),b.append(e);const r=(t,e,r)=>{d=a.createPath(t,!1);let n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d",d),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"stroke",e.stroke.color??"rgb(0, 100, 200)"),n.setAttributeNS(null,"stroke-opacity",e.stroke.opacity??1),n.setAttributeNS(null,"stroke-width",e.stroke.width??.25),e.stroke.dasharray&&n.setAttributeNS(null,"stroke-dasharray",e.stroke.dasharray),n.setAttributeNS(null,"vector-effect","non-scaling-stroke"),r.appendChild(n)};for(const[n,a]of Object.entries(x.cleanup.grid.lineGroups)){let o=document.createElementNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"layer",`Grid_${n}`),e.append(o),x1=t.x,x2=t.x+t.width,yStart=Math.ceil(t.y/a.distance)*a.distance;for(let e=yStart;e<t.y+t.height;e+=a.distance)r([x1,e,x2,e],a,o);y1=t.y,y2=t.y+t.height,xStart=Math.ceil(t.x/a.distance)*a.distance;for(let e=xStart;e<t.x+t.width;e+=a.distance)r([e,y1,e,y2],a,o)}}}}}else console.log("no symbol layers found");const y=(t,e,r)=>{const n=t.attributes.getNamedItem(e);n?n.value=r:a.addAttribute(t.attributes,e,r)},w=x.cleanup.unitScaling.strokeWidth;w&&[...b.querySelectorAll("circle, ellipse, line, path, polygon, polyline, rect, text, textPath, tref, tspan")].forEach((t=>{t.closest('[layer="Symbol"]')&&(y(t,"stroke-width",w),t.removeAttribute("vector-effect"))}));let M=[...b.querySelectorAll("path, polyline, line, text, textPath, tref, tspan")];M.forEach((t=>{y(t,"stroke-linecap","round")})),M=[...b.querySelectorAll("path, polygon, polyline, rect, text, textPath, tref, tspan")],M.forEach((t=>{y(t,"stroke-linejoin","round")}))}return(new XMLSerializer).serializeToString(y)},e.main=function(){},r.c[r.s]}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n](o,o.exports,r),o.loaded=!0,o.exports}r.c=e,r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r(r.s=612)})();